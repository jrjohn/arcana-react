import{c as E,b as F,u as S,r as d,j as e,L as C}from"./index-DG-3HkhA.js";const P=[{id:1,email:"george.bluth@reqres.in",first_name:"George",last_name:"Bluth",avatar:"https://reqres.in/img/faces/1-image.jpg"},{id:2,email:"janet.weaver@reqres.in",first_name:"Janet",last_name:"Weaver",avatar:"https://reqres.in/img/faces/2-image.jpg"},{id:3,email:"emma.wong@reqres.in",first_name:"Emma",last_name:"Wong",avatar:"https://reqres.in/img/faces/3-image.jpg"},{id:4,email:"eve.holt@reqres.in",first_name:"Eve",last_name:"Holt",avatar:"https://reqres.in/img/faces/4-image.jpg"},{id:5,email:"charles.morris@reqres.in",first_name:"Charles",last_name:"Morris",avatar:"https://reqres.in/img/faces/5-image.jpg"},{id:6,email:"tracey.ramos@reqres.in",first_name:"Tracey",last_name:"Ramos",avatar:"https://reqres.in/img/faces/6-image.jpg"},{id:7,email:"michael.lawson@reqres.in",first_name:"Michael",last_name:"Lawson",avatar:"https://reqres.in/img/faces/7-image.jpg"},{id:8,email:"lindsay.ferguson@reqres.in",first_name:"Lindsay",last_name:"Ferguson",avatar:"https://reqres.in/img/faces/8-image.jpg"},{id:9,email:"tobias.funke@reqres.in",first_name:"Tobias",last_name:"Funke",avatar:"https://reqres.in/img/faces/9-image.jpg"},{id:10,email:"byron.fields@reqres.in",first_name:"Byron",last_name:"Fields",avatar:"https://reqres.in/img/faces/10-image.jpg"},{id:11,email:"george.edwards@reqres.in",first_name:"George",last_name:"Edwards",avatar:"https://reqres.in/img/faces/11-image.jpg"},{id:12,email:"rachel.howell@reqres.in",first_name:"Rachel",last_name:"Howell",avatar:"https://reqres.in/img/faces/12-image.jpg"}];function A(){const{id:c}=E(),h=F(),{t:a}=S(),m=!!c,[l,p]=d.useState({firstName:"",lastName:"",email:"",avatar:""}),[n,g]=d.useState({}),[N,b]=d.useState(m),[o,v]=d.useState(!1),[j,x]=d.useState(null);d.useEffect(()=>{m&&c&&(async()=>{b(!0);try{const s=await fetch(`https://reqres.in/api/users/${c}`);if(!s.ok)throw new Error("API not available");const t=await s.json();if(t.data){const i=t.data;p({firstName:i.first_name,lastName:i.last_name,email:i.email,avatar:i.avatar||""})}else throw new Error("Invalid response")}catch{console.log("API unavailable, using mock data");const s=P.find(t=>t.id===Number(c));s?p({firstName:s.first_name,lastName:s.last_name,email:s.email,avatar:s.avatar||""}):x(a("error.not.found"))}finally{b(!1)}})()},[c,m,a]);const y=(r,s)=>{const t=/^[a-zA-Z\s\-']+$/;switch(r){case"firstName":if(!s.trim())return a("user.form.error.first.name.required");if(s.length<2)return a("user.form.error.first.name.min");if(s.length>50)return a("user.form.error.first.name.max");if(!t.test(s))return a("user.form.error.first.name.pattern");break;case"lastName":if(!s.trim())return a("user.form.error.last.name.required");if(s.length<2)return a("user.form.error.last.name.min");if(s.length>50)return a("user.form.error.last.name.max");if(!t.test(s))return a("user.form.error.last.name.pattern");break;case"email":if(!s.trim())return a("user.form.error.email.required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return a("user.form.error.email.invalid");break;case"avatar":if(s.trim()&&!/^https?:\/\/.+/.test(s))return a("user.form.error.avatar.invalid");break}},f=r=>{const{name:s,value:t}=r.target;p(i=>({...i,[s]:t})),n[s]&&g(i=>({...i,[s]:void 0}))},u=r=>{const{name:s,value:t}=r.target,i=y(s,t);i&&g(q=>({...q,[s]:i}))},_=()=>{const r={};return Object.keys(l).forEach(s=>{const t=s,i=y(t,l[t]);i&&(r[t]=i)}),g(r),Object.keys(r).length===0},k=async r=>{if(r.preventDefault(),!!_()){v(!0),x(null);try{const s=m?`https://reqres.in/api/users/${c}`:"https://reqres.in/api/users";await fetch(s,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:l.firstName,last_name:l.lastName,email:l.email,avatar:l.avatar})}).catch(()=>{console.log("API unavailable, proceeding with mock save")}),h("/users")}catch{h("/users")}finally{v(!1)}}},w=()=>{const r=l.firstName.charAt(0)||"",s=l.lastName.charAt(0)||"";return`${r}${s}`.toUpperCase()||"?"};return e.jsxs("div",{className:"user-form-page container-fluid py-4",children:[e.jsxs("button",{className:"btn btn-outline-secondary mb-3",onClick:()=>h("/users"),children:[e.jsx("i",{className:"bi bi-arrow-left me-2"}),a("common.back")]}),e.jsxs("div",{className:"page-header mb-4",children:[e.jsx("h2",{className:"mb-1",children:a(m?"user.form.edit.title":"user.form.create.title")}),e.jsx("p",{className:"text-muted mb-0",children:a(m?"user.form.edit.subtitle":"user.form.create.subtitle")})]}),j&&e.jsxs("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[e.jsx("i",{className:"bi bi-exclamation-triangle me-2"}),j,e.jsx("button",{type:"button",className:"btn-close",onClick:()=>x(null)})]}),N&&e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:a("common.loading")})}),e.jsx("p",{className:"mt-3 text-muted",children:a("user.form.loading")})]}),!N&&e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:k,noValidate:!0,children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"firstName",className:"form-label",children:[a("user.form.field.first.name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",id:"firstName",name:"firstName",className:`form-control ${n.firstName?"is-invalid":""}`,placeholder:a("user.form.placeholder.first.name"),value:l.firstName,onChange:f,onBlur:u,disabled:o}),n.firstName&&e.jsx("div",{className:"invalid-feedback",children:n.firstName})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"lastName",className:"form-label",children:[a("user.form.field.last.name")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",id:"lastName",name:"lastName",className:`form-control ${n.lastName?"is-invalid":""}`,placeholder:a("user.form.placeholder.last.name"),value:l.lastName,onChange:f,onBlur:u,disabled:o}),n.lastName&&e.jsx("div",{className:"invalid-feedback",children:n.lastName})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"form-label",children:[a("user.form.field.email")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",id:"email",name:"email",className:`form-control ${n.email?"is-invalid":""}`,placeholder:a("user.form.placeholder.email"),value:l.email,onChange:f,onBlur:u,disabled:o}),n.email&&e.jsx("div",{className:"invalid-feedback",children:n.email})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"avatar",className:"form-label",children:[a("user.form.field.avatar"),e.jsxs("span",{className:"text-muted ms-1",children:["(",a("user.form.optional"),")"]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"url",id:"avatar",name:"avatar",className:`form-control ${n.avatar?"is-invalid":""}`,placeholder:a("user.form.placeholder.avatar"),value:l.avatar,onChange:f,onBlur:u,disabled:o}),e.jsx("span",{className:"input-group-text p-0",children:l.avatar?e.jsx("img",{src:l.avatar,alt:"Avatar preview",className:"avatar-preview",onError:r=>{r.target.style.display="none"}}):e.jsx("div",{className:"avatar-preview avatar-initials",children:w()})})]}),n.avatar&&e.jsx("div",{className:"text-danger small mt-1",children:n.avatar})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(C,{to:"/users",className:"btn btn-outline-secondary",children:a("user.form.button.cancel")}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2"}),a("user.form.button.saving")]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-lg me-2"}),a(m?"user.form.button.update":"user.form.button.create")]})})]})]})})})}),e.jsx("div",{className:"col-lg-4 mt-4 mt-lg-0",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"card-title",children:[e.jsx("i",{className:"bi bi-question-circle me-2 text-primary"}),a("user.form.help.title")]}),e.jsxs("ul",{className:"list-unstyled small text-muted mb-0",children:[e.jsxs("li",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-check text-success me-2"}),a("user.form.help.name.length")]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-check text-success me-2"}),a("user.form.help.name.characters")]}),e.jsxs("li",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-check text-success me-2"}),a("user.form.help.email.format")]}),e.jsxs("li",{children:[e.jsx("i",{className:"bi bi-check text-success me-2"}),a("user.form.help.avatar.optional")]})]})]})})})]})]})}export{A as UserFormComponent};
